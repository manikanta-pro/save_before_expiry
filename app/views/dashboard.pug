extends dashboard-layout

block content
  section.dashboard-hero
    .hero-text
      h2 Inventory Dashboard
      p A quick health check on near-expiry stock, discounts, and pickup hotspots.
      .hero-actions
        a.btn-primary(href="/inventory/create") + Create Item
        a.btn-ghost(href="/about") Learn How It Works
    .hero-highlight
      span.label Expiring in 3 days
      span.value #{summary.expiringSoon || 0}
      p.subtext Items to spotlight before they go to waste.

  section.filters
    form.filter-form(method="get", action="/dashboard")
      .filter-group
        label(for="search") Search
        input#search(type="text", name="search", placeholder="Product or location", value=(filters && filters.search) || "")
      .filter-group
        label(for="category") Category
        select#category(name="category")
          option(value="") All categories
          if categories && categories.length
            each cat in categories
              option(value=cat.category selected=(filters && filters.category === cat.category) ? true : undefined)= cat.category
      .filter-group
        label(for="status") Status
        select#status(name="status")
          option(value="") All statuses
          option(value="available" selected=filters && filters.status === "available") Available
          option(value="reserved" selected=filters && filters.status === "reserved") Reserved
          option(value="claimed" selected=filters && filters.status === "claimed") Claimed
          option(value="expired" selected=filters && filters.status === "expired") Expired
      button.btn-primary(type="submit") Apply filters
      if filters && (filters.search || filters.category || filters.status)
        a.btn-ghost(href="/dashboard") Clear

  section.metrics
    h2 Inventory Pulse
    .metric-grid
      .metric-card
        span.label Total Items
        span.number #{summary.totalItems || 0}
        span.helper Live deals tracked across locations.
      .metric-card
        span.label Ready to Claim
        span.number #{summary.availableItems || 0}
        span.helper Available to shoppers now.
      .metric-card
        span.label Reserved
        span.number #{summary.reservedItems || 0}
        span.helper Held for recent orders.
      .metric-card
        span.label Claimed / Cleared
        span.number #{(summary.claimedItems || 0) + (summary.expiredItems || 0)}
        span.helper Picked up or marked expired.

  section.table-section
    h2 Expiring Soonest
    if expiringItems && expiringItems.length
      table.data-table
        thead
          tr
            th Product
            th Category
            th Location
            th Expiry
            th Qty
            th Original
            th Discounted
            th Discount
            th Status
        tbody
          each item in expiringItems
            tr
              td
                a.product-link(href=`/products/${item.id}`)
                  strong= item.product_name
              td= item.category || '—'
              td= item.location
              td= item.expiry_date
              td= item.quantity
              td £#{item.original_price}
              td £#{item.discounted_price}
              td #{item.discount_percent}%
              td
                span.status-pill(class=`status-${item.status}`)= item.status
    else
      p.no-data No items found yet. Seed the inventory table to see activity.
